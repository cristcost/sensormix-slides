<!DOCTYPE html>
<html>
<head>
  <title></title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="stylesheet" media="all" href="theme/css/default.css">
  <link rel="stylesheet" media="all" href="theme/css/svg.css">
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->
  <script data-main="js/slides" src="js/require-1.0.8.min.js"></script>
</head>
<body style="opacity: 0" data-lang="en">

<svg>
  <defs>
    <filter id="box-shadow-filter" x="0" y="0">
      <feGaussianBlur stdDeviation="5"/>
      <feOffset dx="10" dy="10"/>
    </filter>
    <marker id="arrow" orient="auto" refX="0" refY="0" style="stroke-linecap:butt;overflow:visible">
      <path 
      d="M 0.5,0 -5,3 -5,-3 z" />
    </marker>
  </defs>
</svg>

<slides class="layout-widescreen">
  
  <slide class="logoslide nobackground">
    <article class="flexbox vcenter">
      <span><img src="images/gdg_firenze_logo.png"></span>
    </article>
  </slide>

  <slide class="title-slide segue nobackground">
    <aside class="gdbar"><img src="images/logo_sensormix_c.png"></aside>
    <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
    </hgroup>
  </slide>

  <slide>
    <hgroup>
      <h2>Who We Are</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <svg height="496" width="780">
        <g transform="translate(193,248)">
          <g>
            <text class="who-we-are-text" filter="url(#box-shadow-filter)">Cristiano</text>
            <text class="who-we-are-text">Cristiano</text>
            <animateMotion begin="0s" dur="25s" path="m 0,0 c 0,-61.84 88.02,-111.98 196.60,-111.98 108.58,0 196.60,50.13 196.60,111.98 0,61.84 -88.02,111.98 -196.60,111.98 C 88.02,111.98 0,61.84 0,0 z" repeatCount="indefinite"/>
          </g>
          <g>
            <text class="who-we-are-text" filter="url(#box-shadow-filter)">Giuseppe</text>
            <text class="who-we-are-text">Giuseppe</text>
            <animateMotion begin="5s" dur="25s" path="m 0,0 c 0,-61.84 88.02,-111.98 196.60,-111.98 108.58,0 196.60,50.13 196.60,111.98 0,61.84 -88.02,111.98 -196.60,111.98 C 88.02,111.98 0,61.84 0,0 z" repeatCount="indefinite"/>
          </g>
          <g>
            <text class="who-we-are-text" filter="url(#box-shadow-filter)">Michele</text>
            <text class="who-we-are-text">Michele</text>
            <animateMotion begin="10s" dur="25s" path="m 0,0 c 0,-61.84 88.02,-111.98 196.60,-111.98 108.58,0 196.60,50.13 196.60,111.98 0,61.84 -88.02,111.98 -196.60,111.98 C 88.02,111.98 0,61.84 0,0 z" repeatCount="indefinite"/>
          </g>
          <g>
            <text class="who-we-are-text" filter="url(#box-shadow-filter)">Sergio</text>
            <text class="who-we-are-text">Sergio</text>
            <animateMotion begin="15s" dur="25s" path="m 0,0 c 0,-61.84 88.02,-111.98 196.60,-111.98 108.58,0 196.60,50.13 196.60,111.98 0,61.84 -88.02,111.98 -196.60,111.98 C 88.02,111.98 0,61.84 0,0 z" repeatCount="indefinite"/>
          </g>
          <g>
            <text class="who-we-are-text" filter="url(#box-shadow-filter)">Stefano</text>
            <text class="who-we-are-text">Stefano</text>
            <animateMotion begin="20s" dur="25s" path="m 0,0 c 0,-61.84 88.02,-111.98 196.60,-111.98 108.58,0 196.60,50.13 196.60,111.98 0,61.84 -88.02,111.98 -196.60,111.98 C 88.02,111.98 0,61.84 0,0 z" repeatCount="indefinite"/>
          </g>
        </g>
      </svg>
    </article>
  </slide>

   <slide>
    <hgroup>
      <h2>Agenda</h2>
    </hgroup>
    <article>
      <ul>
        <li class="yellow3"><b>Intro to OSGi and ServiceMix</b></li>
        <li class="blue3"><b>Intro to Apache Camel</b></li>
        <li class="red3"><b>Using GWT over ServiceMix</b></li>
        <li class="green3"><b>SensorMix: Architecture Demo</b></li>
        <li class="gray4"><b>Cool Facts: why we love this architecture</b></li>
      </ul>
    </article>
  </slide>




  <!-- Introduzione a OSGi e ServiceMix -->
  <slide class="segue back-yellow nobackground">
    <aside class="gdbar"><img src="images/logo_sensormix_c.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Intro to OSGi and ServiceMix</h2>
      <h3>A modular approach for Service Oriented backends</h3>
    </hgroup>
  </slide>

  <slide class="header-yellow">
    <hgroup>
      <h2>Let's meet OSGi</h2>
    </hgroup>
    <article>
      <ul>
        <li>OSGi: Open Service Gateway initiative</li>
        <li>OSGi Alliance: is a non-profit corporation founded in March 1999 by <a href="http://it.wikipedia.org/wiki/Ericsson">Ericsson</a>, <a href="http://it.wikipedia.org/wiki/IBM">IBM</a>, <a href="http://it.wikipedia.org/wiki/Oracle">Oracle</a> and others</li>
        <li>OSGi Framework: modularity layer for Java platform</li>
      </ul>
      <p>The core specifications defines the software lifecycle, modules, services registry and an execution environment.</p>
    </article>
  </slide>

  <slide class="header-yellow">
    <hgroup>
      <h2>A Metaphor:</h2>
      <h3>Think to Windows services or Unix daemons but completely Java</h3>
    </hgroup>
    <article class="flexbox">
      <div class="build fade">

        <img style="position: absolute;left:50%;margin-left:-420px;margin-top:-30px;" src="images/servicemix_windows_services.png" alt="OSGi as Windows Services" title="OSGi as Windows Services" />
        <img style="position: absolute;left:50%;margin-left:-310px;margin-top:20px;" src="images/servicemix_linux_daemons.png" alt="OSGi as Unix Daemons" title="OSGi as Unix Daemons" />
        <img style="position: absolute;left:50%;margin-left:-255px;" src="images/servicemix_felix.png" alt="OSGi as a platform of services in Java" title="OSGi as a platform of services in Java" />

      </div>
    </article>
  </slide>

  <slide class="header-yellow">
    <hgroup>
      <h2>Why OSGi is born</h2>
    </hgroup>
    <article>
      <p>OSGi is born with the goal of creating Java embedded systems for residential, automotive and M2M markets.    
        In these contexts it is often required communicating with devices using different protocols.</p>
      <p>
        So his initial objective was to provide a programming model that allow implementing end-to-end services having an abstraction layer that allow unification of different protocols.</p>
    </article>
  </slide>

  <slide class="header-yellow">
    <hgroup>
      <h2>Why it grows?</h2>
    </hgroup>
    <article class="flexbox vleft auto-fadein smaller">
      <q>
        We’ve all used development platforms in the past, such as Java Enterprise Edition (JEE), and even though there have been great advances in this industry, we’re still building large complex systems, which are hard to develop, maintain, and extend.
      </q>
      <div class="author">
        <br/>Alexandre de Castro Alves<br/>
        OSGi in Depth - Manning, <br/>
        pagina 1, riga 1
      </div>
    </article>
  </slide>

  <slide class="header-yellow">
    <hgroup>
      <h2>OSGi Implementations</h2>
    </hgroup>
    <article class="bigger">
      <p>The specifications enables the creation of multiple implementations of the core framework:</p>
      <ul>
        <li>Apache Felix</li>
        <li>Eclipse Equinox</li>
        <li>Knopflerfish</li>
      </ul>
    </article>
  </slide>
 
   <slide class="header-yellow">
    <hgroup>
      <h2>The OSGi framework</h2>
    </hgroup>
    <article>
      <svg style="float:right;" height="496" width="370">
        <g>
          <g transform="translate(160,10)">
            <rect x="-150" height="240" class="diagram-block-shadow" width="300"/>
            <rect x="-150" height="80" class="diagram-block" width="300"/>
            <text y="55">
              <tspan class="diagram-block-text">Service</tspan>
            </text>
          </g>
          <g transform="translate(160,90)">
            <rect x="-150" height="80" class="diagram-block" width="300"/>
            <text y="55">
              <tspan class="diagram-block-text">Lifecycle</tspan>
            </text>
          </g>
          <g transform="translate(160,170)">
            <rect x="-150" height="80" class="diagram-block" width="300"/>
            <text y="55">
              <tspan class="diagram-block-text">Module</tspan>
            </text>
          </g>
        </g>
      </svg>
      <p>OSGi framework can be represented with three layers:</p>
      <ul class="build fade">
        <li>The <b>module</b> layer defines the OSGi module concept, called Bundle</li>
        <li>The <b>lifecycle</b> layer defines how bundles are dinamically installed and managed int the OSGi framework</li>
        <li>The <b>service</b> layer supports and promotes a flexible application programming model incorporating concepts popularized by service-oriented computing</li>
      </ul>
    </article>
  </slide>

  <slide class="header-yellow">
    <hgroup>
      <h2>The “Module layer”</h2>
    </hgroup>
    <article>
      <img style="width:370px;float:right;" src="images/servicemix_image_2.png" alt="OSGi Bundles" title="OSGi Bundles" />
      <p>The core concept of the module layer is the <b>Bundle</b>.</p>
      <p>The Bundle is a JAR file that contains extra metadata (manifest).</p>

      <div class="build">
        <p>Compared to a regular JAR, a Bundle has:</p>
        <ul>
          <li>a “closed” classpath </li>
          <li>a more expensive manifest</li>
        </ul>
        <p>Thanks to the manifest it is possible to extend classpath visibility</p>
      </div>
    </article>
  </slide>

  <slide class="header-yellow">
    <hgroup>
      <h2>The OSGi manifest</h2>
    </hgroup>
    <article>
      <p>In the manifest it can be specified:</p>
      <ul>
        <li>Bundle identification and description</li>
        <li>Bundle classloading</li>
        <li>Bundle activation</li>
      </ul>
      <p>Examples:</p>
    </article>
  </slide>
<slide class="header-yellow">
    <hgroup>
      <h2>The OSGi manifest</h2>
      <h3>Manifest of a simple JAR built with maven</h3>
    </hgroup>
    <article class="smaller">
      <pre class="prettyprint" data-lang="manifest.mf">
Manifest-Version: 1.0
Build-Jdk: 1.7.0_40
Built-By: gdg-firenze
Created-By: Apache Maven
      </pre>
    </article>
  </slide>
  <slide class="header-yellow">
    <hgroup>
      <h2>The OSGi manifest</h2>
      <h3>Manifest of a Bundle</h3>
    </hgroup>
    <article class="smaller">
      <pre class="prettyprint" data-lang="manifest.mf">
Manifest-Version: 1.0
<b>Bnd-LastModified: 1386750447262</b>
Build-Jdk: 1.7.0_40
Built-By: gdg-firenze
<b>Bundle-ManifestVersion: 2</b>
<b>Bundle-Name: GDG Firenze :: Sensormix :: Example Bundle</b>
<b>Bundle-SymbolicName: example-bundle</b>
<b>Bundle-Vendor: GDG Firenze :: Sensormix Team</b>
<b>Bundle-Version: 1.0.0.SNAPSHOT</b>
<b>Bundle-Activator: com.google.developers.gdgfirenze.dataservice.Activator</b>
Created-By: Apache Maven Bundle Plugin
<b>Export-Package: 
 com.google.developers.gdgfirenze.model;version="1.0.0.SNAPSHOT",
 com.google.developers.gdgfirenze.osgi;version="1.0.0.SNAPSHOT",
 com.google.developers.gdgfirenze.service;version="1.0.0.SNAPSHOT"</b>
<b>Import-Package: 
 javax.jws,javax.jws.soap,javax.xml.bind.annotation,javax.xml.ws</b>
<b>Tool: Bnd-1.50.0</b>
      </pre>
    </article>
  </slide>

  <slide class="header-yellow">
    <hgroup>
      <h2>The “Lifecycle layer”</h2>
      <h3>The lifecycle layer server two different purposes:</h3>
    </hgroup>
    <article>
    <p>Externally it defines the bundle lifecycle.</p>
    <img src="images/servicemix_image_3.png" alt="OSGi Lifecycle" title="OSGi Lifecycle" />
    </article>
  </slide>

  <slide class="header-yellow">
    <hgroup>
      <h2>The “Lifecycle layer”</h2>
      <h3>The lifecycle layer server two different purposes:</h3>
    </hgroup>
    <article>
      <p>Internally it defines the Bundle Activator </p>
      <img src="images/servicemix_image_4.png" alt="OSGi Bundle Activator" title="OSGi Bundle Activator" />
      <div class="build"><p>= public static void main(String[] args)</p></div>
    </article>
  </slide>

  <slide class="header-yellow">
    <hgroup>
      <h2>The “Service layer”</h2>
    </hgroup>
    <article>
      <p>OSGi service layer promotes an interface-based development approach and the separation of interface and implementation.</p>
      <p>OSGi services are Java interfaces representing a conceptual contract between service providers and service clients.</p>
      <img src="images/servicemix_image_5.png" alt="OSGi Bundle Activator" title="OSGi Bundle Activator" />
    </article>
  </slide>


  <slide class="header-yellow">
    <hgroup>
      <h2>The OSGi Service Platform</h2>
    </hgroup>
    <article>
      <img style="width:370px;float:right;" src="images/servicemix_image_6.png" alt="OSGi Service Platform" title="OSGi Service Platform" />
      <p>OSGi specifications define a set of service to improve modular application development</p>
      <ul>
        <li>Configuration Admin (hot configuration)</li>
        <li>Event Admin</li>
        <li>Console Admin</li>
        <li>Log Service</li>
        <li>Blueprint component framework</li>
      </ul>
    </article>
  </slide>

  <slide class="header-yellow">
    <hgroup>
      <h2>Karaf: an OSGi container</h2>
    </hgroup>
    <article>
      <p>Karaf is an OSGi container in which we can find several bundles (and services). This bundles provide additional functionalities like  Hot deployment, Dynamic configuration, Logging System, Extensible Shell console (SSH).</p>
      <p>Karaf its a tipical example of OSGi architecture</p>
      <img src="images/servicemix_image_7.png" alt="Apache Karaf Architecture" title="Apache Karaf Architecture" />
    </article>
  </slide>




  <slide class="header-yellow">
    <hgroup>
      <h2>ServiceMix: an ESB on OSGi</h2>
    </hgroup>
    <article class="smaller">
      <img style="width:370px;float:right;" src="images/servicemix_image_8.png" alt="OSGi Service Platform" title="OSGi Service Platform" />
      <p>ServiceMix extends further the Karaf framework with features for implementing an Enterprise Service Bus.</p>
      <p>Main ServiceMix functionality are:</p>
      <ul>
        <li>Reliable messaging with <a href="http://activemq.apache.org/">Apache ActiveMQ</a></li>
        <li>Messaging, routing and Enterprise Integration Patterns with <a href="http://camel.apache.org">Apache Camel</a></li>
        <li>WS-\* and RESTful web services with <a href="http://cxf.apache.org">Apache CXF</a></li>
        <li>OSGi-based server runtime powered by <a href="http://karaf.apache.org">Apache Karaf</a></li>
      </ul>

      <p>In addition ServiceMix provides:</p>
      <ul>
        <li>Loosely coupled integration between all the other components with Apache ServiceMix NMR including rich Event, Messaging and Audit API</li>
        <li>Complete WS-BPEL engine with <a href="http://ode.apache.org">Apache ODE</a></li>
      </ul>

    </article>
  </slide>

  <slide class="header-yellow">
    <hgroup>
      <h2>OSGi and Spring</h2>
      <h3>Use of Spring in Karaf/ServiceMix</h3>
    </hgroup>
    <article class="smaller">
      <p>Springframework provides many features (dependency injection, ORM, AOP,...)</p>
      <p>Karaf/ServiceMix includes a bundle, the Spring Deployer, that scans and detects Spring files within the folder META-INF/spring of a Jar, and it starts the beans defined inside these files without the need of using OSGi API</p>

<pre class="prettyprint" data-lang="Spring">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; 
  xmlns:context=&quot;http://www.springframework.org/schema/context&quot; 
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
  xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
  http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&quot;&gt;

  &lt;bean id=&quot;consumer&quot; class=&quot;com.myapplication.HelloWorldConsumer&quot; 
    <b>destroy-method=&quot;osgiDestroy&quot; init-method=&quot;osgiInit&quot;</b>/&gt;
    
&lt;/beans&gt;
</pre>
    </article>
  </slide>

  <slide class="header-yellow">
    <hgroup>
      <h2>OSGi and Spring</h2>
      <h3>Spring DM</h3>
    </hgroup>
    <article class="smaller">
      <p>Spring DM allows using OSGi services from Spring in a transparent way.</p>
<pre class="prettyprint" data-lang="Spring DM">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
  <b>xmlns:osgi=&quot;http://www.springframework.org/schema/osgi&quot;</b>
  xmlns:util=&quot;http://www.springframework.org/schema/util&quot; 
  xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
  <b>xsi:schemaLocation=&quot;http://www.springframework.org/schema/osgi 
         http://www.springframework.org/schema/osgi/spring-osgi.xsd&quot;&gt;</b>

  <b>&lt;osgi:service ref=&quot;eventService&quot;
      interface=&quot;com.myapplication.HelloWorldService&quot; /&gt;</b>

&lt;/beans&gt;
</pre>
    </article>
  </slide>

  <!-- Introduzione Camel -->
  <slide class="segue back-blue nobackground">
    <aside class="gdbar"><img src="images/logo_sensormix_c.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Intro to Apache Camel</h2>
      <h3>An agile way to integrate heterogeneous systems</h3>
    </hgroup>
  </slide>

  <slide class="header-blue">
    <hgroup>
      <h2>“To integrate”</h2>
    </hgroup>
    <article class="build">
      <p>What does we mean when we talk about integration?</p>
      <p>To find a solution to the following problem:</p>
      <q>How can I integrate multiple applications so that they work together and can exchange information?</q>
    </article>
  </slide>

  <slide class="header-blue">
    <hgroup>
      <h2>Enterprise Integration Patterns</h2>
    </hgroup>
    <article>
      <p>Enterprise Integration Patters provide solutions for challenging the previous problem.</p>
      <p>What is Enterprise Integration Patters?</p>
    </article>
  </slide>

  <slide class="fill nobackground" style="background-image: url(images/eipbook.jpg)">
    <hgroup>
      <h2 class="white">It's a book!</h2>
    </hgroup>
    <footer><a class="source white" href="http://www.eaipatterns.com/">Gregor Hohpe and Bobby Woolf<br/>Addison-Wesley 2003</a></footer>
  </slide>

  <slide class="header-blue">
    <hgroup>
      <h2>Significant Patterns</h2>
    </hgroup>
    <article>
      <dl style="font-size: 0.65em;">
        <dt>Message Channel:</dt>
          <dd style="font-size: 0.65em;">How does one application communicate with another using messaging?</dd>
        <dt>Message:</dt>
          <dd style="font-size: 0.65em;">How can two applications connected by a message channel exchange a piece of information?</dd>
        <dt>Message Router:</dt>
          <dd style="font-size: 0.65em;">How can you decouple individual processing steps so that messages can be passed to different filters depending on a set of conditions?</dd>
        <dt>Message Translator:</dt>
          <dd style="font-size: 0.65em;"> How can systems using different data formats communicate with each other using messaging?</dd>
        <dt>Message Endpoint:</dt>
          <dd style="font-size: 0.65em;">How does an application connect to a messaging channel to send and receive messages?</dd>
        <dt>Dead Letter Channel:</dt>
          <dd style="font-size: 0.65em;">What will the messaging system do with a message it cannot deliver?</dd>
        <dt>Message Bus:</dt>
          <dd style="font-size: 0.65em;"> What is an architecture that enables separate applications to work together, but in a decoupled fashion such that applications can be easily added or removed without affecting the others?</dd>
        <dt>Command Message:</dt>
          <dd style="font-size: 0.65em;">How can messaging be used to invoke a procedure in another application?</dd>
        <dt>Document Message:</dt>
          <dd style="font-size: 0.65em;">How can messaging be used to transfer data between applications?</dd>
        <dt>Event Message:</dt>
          <dd style="font-size: 0.65em;">How can messaging be used to transmit events from one application to another?</dd>
        <dt>Request-Reply:</dt>
          <dd style="font-size: 0.65em;">When an application sends a message, how can it get a response from the receiver?</dd>
        <dt>Canonical Data Model:</dt>
          <dd style="font-size: 0.65em;">How can you minimize dependencies when integrating applications that use different data formats?</dd>
      </dl>
    </article>
  </slide>

  <slide class="header-blue">
    <hgroup>
      <h2>How can we integrate?</h2>
    </hgroup>
    <article>
      <p>The main approaches for integration are:</p>
      <ul class="build">
        <li>File Transfer
          <div style="position:absolute;right:0px;top:0px;background-color:white;width:345px;height:153px;"><img src="images/camel_eip_file.gif" alt="EIP File Transfer" title="EIP File Transfer" /></div></li>
        <li>Shared Database
          <div style="position:absolute;right:0px;top:0px;background-color:white;width:345px;height:153px;"><img src="images/camel_eip_db.gif" alt="EIP Shared DB" title="EIP Shared DB" /></div></li>
        <li>Remote Procedure Invocation
          <div style="position:absolute;right:0px;top:0px;background-color:white;width:345px;height:153px;"><img src="images/camel_eip_rmi.gif" alt="EIP Remote Procedure Invocation" title="EIP Remote Procedure Invocation" /></div></li>
        <li>Messaging
          <div style="position:absolute;right:0px;top:0px;background-color:white;width:345px;height:153px;"><img src="images/camel_eip_messaging.gif" alt="EIP Messaging" title="EIP Messaging" /></div></li>
      </ul>
      <div class="build"><p>EIPs focuses on integration via “messaging” and define a specific notation for representing integration solutions.</p></div>
    </article>
  </slide>

  <slide class="fill nobackground" style="background-image: url(images/eipbookcover.jpg)">
    <hgroup>
      <h2 class="white">EIP Notation</h2>
    </hgroup>
    <article class="build flexbox vcenter ">
      <div>
        <img src="images/camel_image_1.png" style="height:560px;margin-top:-50px;" alt="EIP Notation" title="EIP Notation" />
        
        <footer><a class="source white" href="http://www.eaipatterns.com/toc.html">http://www.eaipatterns.com/toc.html</a></footer>
      <div>
    </article>
  </slide>

  <slide class="header-blue">
    <hgroup>
      <h2>Solutions with EIP</h2>
    </hgroup>
     <article class="flexbox vcenter">
      <div>
        <img src="images/camel_eip_1.png" alt="Example of EIP" title="Example of EIP" />
      </div>
    </article>
  </slide>

  <slide class="header-blue">
    <hgroup>
      <h2>Solutions with EIP</h2>
    </hgroup>
     <article class="flexbox vcenter">
      <div>
        <img src="images/camel_eip_2.png" alt="Example of EIP" title="Example of EIP" />
      </div>
    </article>
  </slide>


  <slide class="header-blue">
    <hgroup>
      <h2>Solutions with EIP</h2>
    </hgroup>
     <article class="flexbox vcenter">
      <div>
        <img src="images/sensormix_cdm_eip.png" alt="Example of EIP" title="Example of EIP" />
        <div class="build">
          <h3>Remember this one!</h3>
        </div>
      </div>
    </article>
  </slide>

  <slide class="header-blue">
    <hgroup>
      <h2>How to implement easily EIP solutions?</h2>
      <h3>(rhetorical question)</h3>
    </hgroup>
    <article class="build">
      <p>Integration is still difficult as it exists a wide and heterogeneous set of protocols, interfaces and formats.</p>
      <p>How can we implement Enterprise Integration Patterns on a Java platform?</p>
      <div>
        <p>with</p>
        <q>Apache Camel</q>
        <div class="build">
          <span><b>C</b>oncise</span>
          <span><b>A</b>pplication</span>
          <span><b>M</b>essaging</span>
          <span><b>E</b>xchange</span>
          <span><b>L</b>anguage</span>
        </div>
      </div>
 
    </article>
  </slide>

  <slide class="header-blue">
    <hgroup>
      <h2>Apache Camel</h2>
    </hgroup>
    <article class="build">
      <p>Apache Camel is a versatile open-source integration framework based on known Enterprise Integration Patterns from Hohpe and Woolf's book.</p>
      <p>It includes a wide set of  <a href="http://camel.apache.org/components.html">components</a> for working with many <b>transport protocols</b> and <a href="http://camel.apache.org/data-format.html">data formats</a>  and it allows to define <b>routing</b> and <b>mediation</b> rules by using <a href="http://camel.apache.org/dsl.html">domain-specific language</a>.</p>
      <p>...it so good for integration that ServiceMix, from version 3 to version 4, switched focus from using JBI to adopt a new approach to integration based on Camel and OSGi.</p>
    </article>
  </slide>

  <slide class="header-blue">
    <hgroup>
      <h2>Example: Content Based Router</h2>
    </hgroup>
    <article class="bigger">
      <img style="width:50%;" src="images/camel_eip_3.png" alt="Content Based Router" title="Content Based Router" />
      <p class="build">
          <span>from <b>newOrder</b><br/></span>
          <span>&nbsp;&nbsp;choice<br/></span>
          <span>&nbsp;&nbsp;&nbsp;&nbsp;when <b>isWidget</b> to <b>widget</b><br/></span>
          <span>&nbsp;&nbsp;&nbsp;&nbsp;otherwise to <b>gadget</b></span>
      </p>
    </article>
  </slide>

  <slide class="header-blue">
    <hgroup>
      <h2>Content Based Router in Java DSL</h2>
    </hgroup>
    <article class="smaller">
      <div style="float:right;">
          from <b>newOrder</b><br/>
          &nbsp;&nbsp;choice<br/>
          &nbsp;&nbsp;&nbsp;&nbsp;when <b>isWidget</b> to <b>widget</b><br/>
          &nbsp;&nbsp;&nbsp;&nbsp;otherwise to <b>gadget</b>
      </div>
      <img style="width:50%;" src="images/camel_eip_3.png" alt="Content Based Router" title="Content Based Router" />

<pre class="prettyprint" data-lang="java dsl">
public class MyRoute extends RouteBuilder {

  public void configure() throws Exception {
    <b>from</b>(&quot;<b>activemq:queue:newOrder</b>&quot;)
      .<b>choice</b>()
        .<b>when</b>(xpath(&quot;<b>/order/product = 'widget'</b>&quot;))
          .<b>to</b>(&quot;<b>activemq:queue:widget</b>&quot;)
        .<b>otherwise</b>()
          .<b>to</b>(&quot;<b>activemq:queue:gadget</b>&quot;)
      .end();
  }
}
</pre>
    </article>
  </slide>

  <slide class="header-blue">
    <hgroup>
      <h2>Content Based Router in Spring XML</h2>
    </hgroup>
    <article class="smaller">
      <div style="float:right;">
          from <b>newOrder</b><br/>
          &nbsp;&nbsp;choice<br/>
          &nbsp;&nbsp;&nbsp;&nbsp;when <b>isWidget</b> to <b>widget</b><br/>
          &nbsp;&nbsp;&nbsp;&nbsp;otherwise to <b>gadget</b>
      </div>
      <img style="width:50%;" src="images/camel_eip_3.png" alt="Content Based Router" title="Content Based Router" />
<pre class="prettyprint" data-lang="spring xml">
&lt;camelContext xmlns=&quot;http://camel.apache.org/schema/spring&quot;&gt;
  &lt;route&gt;
    &lt;<b>from</b> uri=&quot;<b>activemq:queue:newOrder</b>&quot;/&gt;
    &lt;<b>choice</b>&gt;
      &lt;<b>when</b>&gt;
        &lt;xpath&gt;<b>/order/product = &apos;widget&apos;</b>&lt;/xpath&gt;
        &lt;<b>to</b> uri=&quot;<b>activemq:queue:widget</b>&quot;/&gt;
      &lt;/when&gt;
      &lt;<b>otherwise</b>&gt;
        &lt;<b>to</b> uri=&quot;<b>activemq:queue:gadget</b>&quot;/&gt;
      &lt;/otherwise&gt;
    &lt;/choice&gt;
  &lt;/route&gt;
&lt;/camelContext&gt;
</pre>
    </article>
  </slide>

  <slide class="header-blue">
    <hgroup>
      <h2>A complete Camel application:</h2>
    </hgroup>
    <article class="smaller">
<pre class="prettyprint" data-lang="spring xml">
import org.apache.camel.CamelContext;
import org.apache.camel.builder.RouteBuilder;
import org.apache.camel.impl.DefaultCamelContext;

public class CamelExample {
  public static void main(String[] args) throws Exception {

    CamelContext context = new DefaultCamelContext();

    context.addRoutes(new RouteBuilder() {
      public void configure() {
        from(&quot;jetty:http://0.0.0.0:8080/tellMeSomething&quot;)
        .transform(simple(&quot;You say ${in.body}&quot;))
        .to(&quot;velocity:response.vm&quot;);
      }
    });

    context.start();
    System.out.println(&quot;Press ENTER to exit&quot;);
    System.in.read();

    context.stop();
  }
}
</pre>
    </article>
  </slide>


  <slide class="header-blue">
    <hgroup>
      <h2>Camel on ServiceMix</h2>
    </hgroup>
    <article>
      <p>As soon as Camel bundles are enabled on Karaf-ServiceMix... </p>
      <div class="build">
        <img src="images/camel_image_3.png" alt="Camel Bundles in ServiceMix" title="Camel Bundles in ServiceMix" />
      </div>
    </article>
  </slide>

  <slide class="header-blue">
    <hgroup>
      <h2>Camel on ServiceMix</h2>
    </hgroup>
    <article class="smaller">
      <p>...it is then possible to define routes directly 
       in Spring XML files, or use a RouteBuilder with Java to start Camel application
       within ServiceMix.</p>
<div class="build">
<pre class="prettyprint" data-lang="Spring XML">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;&gt;

  &lt;camelContext xmlns=&quot;http://camel.apache.org/schema/spring&quot;&gt;
   
    &lt;route&gt;
      &lt;from uri=&quot;jetty:http://0.0.0.0:8080/tellMeSomething&quot;/&gt;
      &lt;convertBodyTo type=&quot;java.lang.String&quot;/&gt;
      &lt;transform&gt;
        &lt;simple&gt;You say ${in.body}&lt;/simple&gt;
      &lt;/transform&gt;
      &lt;to uri=&quot;velocity:response.vm&quot; /&gt;
    &lt;/route&gt;

  &lt;/camelContext&gt;

&lt;/beans&gt;
</pre></div>

    </article>
  </slide>



  <slide class="header-blue">
    <hgroup>
      <h2>Camel: components</h2>
      <h3>162 components listed on <a href="http://camel.apache.org/components.html">camel.apache.org/components.html</a></h3>
    </hgroup>
    <article class="smaller">
      <div style="height:460px;overflow:auto;margin-top:-30px;">
        <table>
          <tr><th></th><td class="highlight">ActiveMQ</td><td>ActiveMQ Broker</td><td>Activiti</td><td>AHC</td><td>AMQP</td><td>APNS</td><td>Atom</td><td>Avro</td></tr>
          <tr><th></th><td>AWS-CW</td><td>AWS-DDB</td><td>AWS-S3</td><td>AWS-SDB</td><td>AWS-SES</td><td>AWS-SNS</td><td>AWS-SQS</td><td>Bean</td></tr>
          <tr><th></th><td>Bean Validation</td><td>Browse</td><td>Cache</td><td>Class</td><td>CMIS</td><td>Cometd</td><td>Context</td><td>ControlBus</td></tr>
          <tr><th></th><td>CouchDB</td><td>Crypto</td><td class="highlight">CXF</td><td>CXF Bean </td><td>CXFRS</td><td>DataFormat</td><td>DataSet</td><td>Db4o</td></tr>
          <tr><th></th><td>Direct</td><td>Direct-VM</td><td>Disruptor</td><td>DNS</td><td>EJB</td><td>ElasticSearch</td><td>Esper</td><td>EventAdmin</td></tr>
          <tr><th></th><td>Exec</td><td>Facebook</td><td class="highlight">File</td><td>Flatpack</td><td>FOP</td><td>FreeMarker</td><td class="highlight">FTP</td><td>FTPS</td></tr>
          <tr><th></th><td>GAuth</td><td>Geocoder</td><td>GHttp</td><td>GLogin</td><td>GMail</td><td>GTask</td><td>Guava EventBus</td><td>Hazelcast</td></tr>
          <tr><th></th><td>HBase</td><td>HDFS</td><td>Hibernate</td><td>HL7</td><td class="highlight">HTTP</td><td>HTTP4</td><td>iBATIS</td><td>IMAP</td></tr>
          <tr><th></th><td>IMAPS</td><td>Infinispan</td><td>IRC</td><td>JavaSpace</td><td>JBI</td><td>JCIFS</td><td>jclouds</td><td>JCR</td></tr>
          <tr><th></th><td>JDBC</td><td class="highlight">Jetty</td><td>JGroups</td><td>JMS</td><td>JMX</td><td>JPA</td><td>Jsch</td><td>JT/400 </td></tr>
          <tr><th></th><td>Kestrel</td><td>Krati</td><td>Language</td><td>LDAP</td><td>Log</td><td>Lucene</td><td>MINA</td><td class="highlight">MINA2</td></tr>
          <tr><th></th><td>Mock</td><td>MongoDB</td><td>MQTT</td><td>MSV</td><td>Mustache</td><td>MVEL</td><td>MyBatis</td><td>Nagios</td></tr>
          <tr><th></th><td class="highlight">Netty</td><td>Netty HTTP</td><td>NMR</td><td>OptaPlanner</td><td>Pax-Logging</td><td>POP3</td><td>POP3S</td><td>Printer</td></tr>
          <tr><th></th><td>Properties</td><td>Quartz</td><td>Quartz2</td><td>Quickfix</td><td>RabbitMQ</td><td>RCode</td><td>Ref</td><td>Restlet</td></tr>
          <tr><th></th><td>RMI</td><td>RNC</td><td>RNG</td><td>Routebox</td><td>RSS</td><td>Salesforce</td><td>SAP NetWeaver</td><td>Scalate</td></tr>
          <tr><th></th><td>SEDA</td><td>SERVLET</td><td>SFTP</td><td>Sip</td><td>SJMS</td><td>Smooks</td><td>SMPP</td><td>SMTP</td></tr>
          <tr><th></th><td>SMTP</td><td>SNMP</td><td>Solr</td><td>Splunk</td><td>Spring Event</td><td>Spring LDAP</td><td>Spring Neo4j</td><td>Spring Redis</td></tr>
          <tr><th></th><td>Spring Web Services</td><td>SpringBatch</td><td>SpringIntegration</td><td>SQL</td><td>StAX</td><td>Stomp</td><td>Stream</td><td>StringTemplate</td></tr>
          <tr><th></th><td>Stub</td><td>Test</td><td>Timer</td><td>Twitter</td><td>Validation</td><td class="highlight">Velocity</td><td>Vertx</td><td>VirtualBox</td></tr>
          <tr><th></th><td class="highlight">VM</td><td>Weather</td><td>Websocket</td><td>XML Security </td><td>XMPP</td><td>XQuery</td><td class="highlight">XSLT</td><td>Yammer</td></tr>
          <tr><th></th><td>ZeroMQ</td><td>Zookeeper</td></tr>
        </table>
      </div>  
    </article>
  </slide>

  <slide class="header-blue">
    <hgroup>
      <h2>Camel: data format</h2>
      <h3>25+ data formats listed <a href="http://camel.apache.org/data-format.html">camel.apache.org/data-format.html</a></h3>
    </hgroup>
    <article>
      <table>
        <tr><th></th><td>Avro</td><td>Base64</td><td>BeanIO</td><td>Bindy</td><td>Castor</td></tr>
        <tr><th></th><td>Crypto</td><td>CSV</td><td>EDI</td><td>Flatpack DataFormat</td><td>GZip data format</td></tr>
        <tr><th></th><td>HL7 DataFormat</td><td class="highlight">JAXB</td><td>JiBX</td><td class="highlight">JSON</td><td>PGP</td></tr>
        <tr><th></th><td class="highlight">Protobuf</td><td class="highlight">Serialization</td><td>SOAP</td><td>String</td><td>XmlBeans</td></tr>
        <tr><th></th><td class="highlight">XmlJson</td><td>XMLSecurity DataFormat</td><td>XStream</td><td>Zip DataFormat</td><td>Zip File DataFormat</td></tr>
      </table>
    </article>
  </slide>


  <!-- Usare GWT su ServiceMix -->
  <slide class="segue back-red nobackground">
    <aside class="gdbar"><img src="images/logo_sensormix_c.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Using GWT on ServiceMix</h2>
      <h3>An alternative way to develop Web Applications</h3>
    </hgroup>
  </slide>

  <slide class="header-red">
    <hgroup>
      <h2>SOA and SOFEA</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/gwt_image_1.png" alt="SOFEA Architecture" title="SOFEA Architecture" />
      <footer class="source"><a href="http://raibledesigns.com/">http://raibledesigns.com/</a></footer>
    </article>
  </slide>

  <slide class="header-red">
    <hgroup>
      <h2>Web Frameworks for SOFEAs</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/gwt_image_2.png" alt="SOFEA Web Frameworks" title="SOFEA Web Frameworks" />
      <footer class="source"><a href="http://raibledesigns.com/">http://raibledesigns.com/</a></footer>
    </article>
  </slide>

  <slide class="header-red">
    <hgroup>
      <h2>ServiceMix and Web Applications</h2>
    </hgroup>
    <article>
      <p>Natively ServiceMix is not a <a href="http://en.wikipedia.org/wiki/Web_container">Web Container</a> but it anyhow allows to deploy web applications. </p>
      <p>In particular this is interesting when our application follow the previous approach.</p>
    </article>
  </slide>

  <slide class="header-red">
    <hgroup>
      <h2>Our SOFEA</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/gwt_image_3.png" alt="SOFEA with GWT and ServiceMix" title="SOFEA with GWT and ServiceMix" />
    </article>
  </slide>

  <slide class="header-red">
    <hgroup>
      <h2>Deploy WARs on Karaf/ServiceMix</h2>
      <h3>WAR Deployer</h3>
    </hgroup>
    <article class="build">
      <p>The WAR Deployer is a bundle that take care of deploying Web Application on Karaf/ServiceMix</p>
      <div style="text-align:center;font-weight:bold;font-size:1.8em;"><p>What does it do?</p></div>
      <ul>
        <li>It search for the /WEB-INF/web.xml file</li>
        <li>If found, it publish the static files and Servlets defined in web.xml via HTTP</li>
      </ul>
      <div style="text-align:center;font-weight:bold;font-size:1.8em;"><p>Is it enough?</p></div>
    </article>
  </slide>

  <slide class="header-red">
    <hgroup>
      <h2>Deploy WARs on Karaf/ServiceMix</h2>
      <h3>The WAR needs some changes</h3>
    </hgroup>
    <article class="build">
      <ul>
        <li>It must have /META-INF/MANIFEST.MF file in the JAR's root</li>
        <li>MANIFEST.MF must have:
          <ul>
            <li>The header <code>Web-ContextPath</code> (the web application will be published to the context path specified by this header)</li>
            <li>The header <code>Bundle-ClassPath: .,WEB-INF/classes</code> (this tell Karaf/ServiceMix where to search for bytecode files)</li>
          </ul>
        </li>
      </ul>

      <p>It is also recommended to create a <a href="http://maven.apache.org/plugins/maven-war-plugin/examples/skinny-wars.html">Skinny War</a> and resolve dependencies from OSGi Bundles (it can be done easily using maven-war-plugin and maven-bundle-plugin)</p>

      <div style="text-align:center;font-weight:bold;font-size:1.8em;"><p>Have we finished?</p></div>

    </article>
  </slide>

  <slide class="header-red">
    <hgroup>
      <h2>GWT applications on Karaf/ServiceMix</h2>
    </hgroup>
    <article>
      <div style="position: absolute; height:496px;top:90px;">
        <img style="position: absolute;left:50%;margin-left:-420px;top:25px;" src="images/gwt_image_4.png" alt="gwt-servlet.jar is not an OSGi Bundle" title="gwt-servlet.jar is not an OSGi Bundle" />
        <p style="margin-top:260px;">...also gwt-servlet.jar need changes!</p>
        <p>GWT is not fitted for use in OSGi.</p>
        <p>It is not a bundle as the manifest of gwt-servlet.jar is missing required OSGi headers.</p>
        <div style="text-align:center;font-weight:bold;font-size:1.8em;"><p>What then?</p></div>
      </div>
    </article>
  </slide>

  <slide class="header-red">
    <hgroup>
      <h2>How to use GWT in OSGi</h2>
      <h3>Four ways:</h3>
    </hgroup>
    <article class="smaller">
      <p>
        There are 4 ways to and OSGi-fied gwt-servlet.jar so that it can be deployed on Karaf/ServiceMix.</p>
      <dl class="build fade">
        <div><dt>Case 1:</dt><dd><a href="http://www.gwtproject.org/makinggwtbetter.html#compiling">Compile</a> manually gwt-servlet.jar with required <a href="https://gwt-review.googlesource.com/#/c/5351/">OSGi headers</a></dd></div>
        <div><dt>Case 2:</dt><dd>Deploy the <a href="http://karaf.apache.org/manual/latest-2.2.x/users-guide/deployer.html#Wrapdeployer">non-OSGi Jar</a> and wrap it as a bundle setting up configuration for the MANIFEST.MF as parameters of the install command</dd></div>
        <div><dt>Case 3:</dt><dd>Wait for ServiceMix Team <a href="http://goo.gl/jFsVcP">to release</a> the Bundle for GWT-Servlet</dd></div>
        <div><dt>Case 4:</dt><dd>Hope that GWT Project Team <a href="https://gwt-review.googlesource.com/#/c/5351/">accepts the patch</a>, that we have proposed, in GWT 2.6.0 or in a near future. </dd></div>
      </dl>
    </article>
  </slide>

  <slide class="header-red">
    <hgroup>
      <h2>How to use GWT in OSGi</h2>
      <h3>What's the impact?</h3>
    </hgroup>
    <article class="smaller">
    <dl style="font-size:0.6em;line-height:1em;">
      <dt>Case 1:</dt>
        <dd>
          <code>git fetch https://gwt.googlesource.com/gwt refs/changes/51/5351/7</code><br/>
          <code>git checkout FETCH_HEAD</code><br/>
          <code>ant dist</code><br/>
          <code>install -s mvn:com.google.gwt/gwt-servlet/2.6.0</code><br/>
        </dd>

      <dt>Case 2:</dt>
        <dd><code>
          install -s wrap:mvn:com.google.gwt/gwt-servlet/2.6.0$Bundle-Name=GWT-Servlet&amp;Bu<br/>
          ndle-SymbolicName=com.google.gwt.gwt-servlet&amp;Bundle-Version=2.6.0&amp;Export-Packag<br/>
          e=com.google.gwt.user.client.rpc.*,org.hibernate.validator.engine,com.google.we<br/>
          b.bindery.requestfactory.vm.impl.*,!javax.validation,!org.hibernate.validator.*<br/>
          ,!*.client.*,!*.impl.*,*&amp;Import-Package=javax.servlet.*,javax.validation;resolu<br/>
          tion:=optional,org.json;resolution:=optional,javax.validation.*;resolution:=opt<br/>
          ional,org.json.*;resolution:=optional,!com.google.gwt.*,*;resolution:=optional</code></dd>

      <dt>Case 3:</dt>
        <dd><code>install -s mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.gwt-servlet/2.6.0_1</code></dd>

      <dt>Case 4:</dt>
        <dd><code>install -s mvn:com.google.gwt/gwt-servlet/2.6.0</code></dd>
    </dl>
    </article>
  </slide>



  <slide class="header-red">
    <hgroup>
      <h2>GWT Samples adapted for Karaf/ServiceMix</h2>
    </hgroup>
    <article class="bigger">

<p>We have adapted some example from GWT distribution for running on Karaf/ServiceMix:</p>

<p><a href="https://github.com/cristcost/gwt-karaf-examples">https://github.com/cristcost/gwt-karaf-examples</a></p>

<p>And next we are going to present the demo of an application that put together all the technologies presented up to now.</p>
    </article>
  </slide>


  <!-- SensorMix -->
  <slide class="segue back-green nobackground">
    <aside class="gdbar"><img src="images/logo_sensormix_c.png"></aside>
    <hgroup class="auto-fadein">
      <h2>SensorMix</h2>
      <h3>Example of an architecture based on ServiceMix, Camel and GWT</h3>
    </hgroup>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2>How SensorMix is composed</h2>
      <h3>External Architecture</h3>
    </hgroup>
    <article>
      <img style="position: absolute;left:50%;margin-left:-340px;margin-top:-50px;" src="images/sensormix_arc_2.png" alt="SensorMix: Interfaces" title="SensorMix: Interfaces" />
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2>How SensorMix is composed</h2>
      <h3>Internal Architecture</h3>
    </hgroup>
    <article>
      <img style="position: absolute;left:50%;margin-left:-340px;margin-top:-50px;" src="images/sensormix_arc_1.png" alt="SensorMix: Architecture" title="SensorMix: Architecture" />
    </article>
  </slide>

  <slide class="header-green">
    <article class="flexbox vcenter">
      <div>
        <h2 style="font-size:10em;">Demo</h2>
      </div>
    </article>
  </slide>

  <!-- Canonical Data Model -->
  <slide class="segue header-green no-back">
    <aside class="gdbar big-green"><img src="images/sensormix_focus_cdm.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Data Model Bundle</h2>
    </hgroup>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2> The Canonical Data Model EIP</h2>
    </hgroup>
    <article>
      <p>From EIP book:</p>
      <div class="build fade">
        <p>“I am designing several applications to work together through Messaging. Each application has its own internal data format.”</p>
        <p>“How can you minimize dependencies when integrating applications that use different data formats?”</p>
        <img src="images/sensormix_cdm_problem.png" alt="Canonical Data Model problem" title="Canonical Data Model problem" />
      </div>
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2> The Canonical Data Model EIP</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <div>
        <img src="images/sensormix_cdm_eip.png" alt="Example of EIP" title="Example of EIP" />
      </div>
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2>Our approach to CDM</h2>
    </hgroup>
    <article class="build">
      <p>We like the <b>Java first</b>:</p>
      <ul>
        <li>Data model: <b>POJO</b></li>
        <li>Services model: <b>Java Interfaces</b></li>
      </ul>
      <p>We use JaxB and JaxWS annotations to generate XML Schema and WSDL from our model.</p>
      <div>
        <p>
          We find starting from objects more natural, linear and agile :</p>
        <ul class="build fade">
          <li>Final XML Schema is cleaner</li>
          <li>We can avoid XML Schema validation: 
            <ul><li>unmarshal Java exception = XML is not valid</li></ul>
          </li>
          <li>Modeling on Java classes is faster (for developers)</li>
        </ul>
      </div>
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2>Binding Java-XML Schema</h2>
    </hgroup>
    <article class="smaller">
<pre class="prettyprint" data-lang="java">
@XmlAccessorType(XmlAccessType.FIELD)
<b>@XmlType(name = &quot;SampleReport&quot;)</b>
public class SampleReport implements Serializable {

  <b>@XmlAttribute(required = true, name = &quot;sensorId&quot;)</b>
  @XmlSchemaType(name = &quot;anyURI&quot;)
  private String sensorId;

  <b>@XmlAttribute(required = false, name = &quot;sampleType&quot;)</b>
  private String sampleType;

  <b>@XmlElement(required = false, name = &quot;dailySampleReport&quot;)</b>
  private List&lt;DailySampleReport&gt; dailySampleReports;
</pre>
<div class="build">
<pre class="prettyprint" data-lang="xml schema">
&lt;<b>xs:complexType name=&quot;SampleReport&quot;</b>&gt;
  &lt;<b>xs:attribute name=&quot;sensorId&quot;</b> type=&quot;xs:anyURI&quot; use=&quot;required&quot;/&gt;
  &lt;<b>xs:attribute name=&quot;sampleType&quot;</b> type=&quot;xs:string&quot;/&gt;
  &lt;xs:sequence&gt;
    &lt;<b>xs:element name=&quot;dailySampleReport&quot;</b> type=&quot;tns:DailySampleReport&quot;
          maxOccurs=&quot;unbounded&quot; minOccurs=&quot;0&quot; /&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
</div>
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2> JaxB annotated POJOs</h2>
    </hgroup>
    <article class="flexbox build fade smaller">
<pre class="prettyprint" data-lang="java">
<b>@XmlAccessorType(XmlAccessType.FIELD)</b>
<b>@XmlType(name = &quot;SampleReport&quot;)</b>
public class SampleReport implements Serializable {

  /** The sensor id. */
  <b>@XmlAttribute(required = true, name = &quot;sensorId&quot;)</b>
  <b>@XmlSchemaType(name = &quot;anyURI&quot;)</b>
  private String sensorId;

  /** The sample type. */
  @XmlAttribute(required = false, name = &quot;sampleType&quot;)
  private String sampleType;

  /** The daily sample reports. */
  @XmlElement(required = false, name = &quot;dailySampleReport&quot;)
  private List&lt;DailySampleReport&gt; dailySampleReports;

  // ...</pre>
      <img style="position: absolute; top: 100px; right: 50px;" src="images/sensormix_cdm_image_1.png" alt="POJO annotated JaxB" title="POJO annotated JaxB" />
    </article>
  </slide>


  <slide class="header-green">
    <hgroup>
      <h2>JaxWS annotated interfaces</h2>
    </hgroup>
 <article class="flexbox build fade smaller">
<pre class="prettyprint" data-lang="java">
<b>@WebService(name = &quot;SensormixService&quot;,
    targetNamespace = &quot;http://developers.google.com/gdgfirenze/ns/service&quot;)</b>
@SOAPBinding(parameterStyle = ParameterStyle.WRAPPED, style = Style.DOCUMENT, use = Use.LITERAL)
public interface SensormixService {

  <b>@WebMethod(action = &quot;urn:#listSensorsIds&quot;)</b>
  @RequestWrapper(localName = &quot;listSensorsIdsIn&quot;,
      targetNamespace = &quot;http://developers.google.com/gdgfirenze/ns/service&quot;)
  @ResponseWrapper(localName = &quot;listSensorsIdsOut&quot;,
      targetNamespace = &quot;http://developers.google.com/gdgfirenze/ns/service&quot;)
  <b>@WebResult(name = &quot;sensorId&quot;)</b>
  List&lt;String&gt; listSensorsIds();

  @WebMethod(action = &quot;urn:#listSamplesTypes&quot;)
  @RequestWrapper(localName = &quot;listSamplesTypesIn&quot;,
      targetNamespace = &quot;http://developers.google.com/gdgfirenze/ns/service&quot;)
  @ResponseWrapper(localName = &quot;listSamplesTypesOut&quot;,
      targetNamespace = &quot;http://developers.google.com/gdgfirenze/ns/service&quot;)
  @WebResult(name = &quot;sampleType&quot;)
  List&lt;String&gt; listSamplesTypes();

  // ...</pre>
      <img style="position: absolute; top: 100px; right: 50px;" src="images/sensormix_cdm_image_2.png" alt="Interfaces annotated JaxWS" title="Interfaces annotated JaxWS" />
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2> Using the CDM on GWT</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <p>Finally, if we want to use our datamodel also on a GWT project, let's add a .gwt.xml module:</p>
      <div class="build fade">
<pre class="prettyprint" data-lang="gwt xml">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!-- When updating your version of GWT, you should also update this DTD reference, 
        so that your app can take advantage of the latest GWT module capabilities. --&gt;
&lt;!DOCTYPE module PUBLIC &quot;-//Google Inc.//DTD Google Web Toolkit 2.5.1//EN&quot;
  &quot;http://google-web-toolkit.googlecode.com/svn/tags
  /2.5.1/distro-source/core/src/gwt-module.dtd&quot;&gt;
&lt;module&gt;

        &lt;!-- Specify the paths for translatable code --&gt;
        &lt;source path='model' /&gt;
        &lt;source path='service' /&gt;

&lt;/module&gt;</pre>
        <img style="position: absolute; top: 100px; right: 50px;" src="images/sensormix_cdm_image_3.png" alt="Interfaces annotated JaxWS" title="Interfaces annotated JaxWS" />
      </div>
    </article>
  </slide>

  <!-- Data Service -->
  <slide class="segue header-green no-back">
    <aside class="gdbar big-green"><img src="images/sensormix_focus_dataservice.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Data Service Bundle</h2>
    </hgroup>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2> The bundle dataservice</h2>
    </hgroup>
    <article>
      <p>It has a service for providing storage and data access capabilities.</p>
      <p>The service is registered in OSGi using Spring DM.</p>
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2> Registering the service</h2>
    </hgroup>
    <article>
<pre class="prettyprint" data-lang="spring dm">
&lt;osgix:cm-properties id=&quot;dataSourceProperties&quot;
  persistent-id=&quot;sensormix.jpa.persistenceunit&quot;&gt;
  &lt;prop key=&quot;sensormix_db.driverClassName&quot;&gt;org.hsqldb.jdbcDriver&lt;/prop&gt;
  &lt;prop key=&quot;sensormix_db.url&quot;&gt;jdbc:hsqldb:mem:sensormix_db&lt;/prop&gt;
  &lt;prop key=&quot;sensormix_db.username&quot;&gt;sa&lt;/prop&gt;
  &lt;prop key=&quot;sensormix_db.password&quot;&gt;&lt;/prop&gt;
&lt;/osgix:cm-properties&gt;

<b>&lt;osgi:service ref=&quot;sensormixService&quot;&gt;
  &lt;osgi:interfaces&gt;
    &lt;value&gt;com.google.developers.gdgfirenze.service.SensormixService&lt;/value&gt;
    &lt;value&gt;com.google.developers.gdgfirenze.osgi.SensormixAdminInterface&lt;/value&gt;
  &lt;/osgi:interfaces&gt;
&lt;/osgi:service&gt;</b>
</pre>
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2> Java code of the service</h2>
    </hgroup>
    <article class="smaller">
<pre class="prettyprint" data-lang="java">
public class SensormixServiceJpaImpl implements SensormixService, SensormixAdminInterface {

  private EntityManagerFactory entityManagerFactory;

  @Override
  public List&lt;String&gt; listSensorsIds() {
    List&lt;String&gt; result = new ArrayList&lt;String&gt;();

    try {
      EntityManager em = entityManagerFactory.createEntityManager();
      TypedQuery&lt;String&gt; q = em.createQuery(&quot;SELECT s.id FROM JpaSensor s&quot;, String.class);

      result.addAll(q.getResultList());

      em.close();
    } catch (Exception e) {
      logger.log(Level.SEVERE, &quot;Error during sensors list retrieving&quot;, e);
    }

    return result;
  }
</pre>
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2> Spring ORM</h2>
    </hgroup>
    <article class="smaller">
<pre class="prettyprint" data-lang="spring dm">
&lt;bean id=&quot;emf&quot; class=&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;&gt;
  &lt;property name=&quot;persistenceUnitName&quot; value=&quot;sensormix_db&quot; /&gt;
  &lt;property name=&quot;jpaVendorAdapter&quot;&gt;
    &lt;bean class=&quot;org.springframework.orm.jpa.vendor.EclipseLinkJpaVendorAdapter&quot;&gt;
      &lt;property name=&quot;showSql&quot; value=&quot;true&quot; /&gt;
    &lt;/bean&gt;
  &lt;/property&gt;
  &lt;property name=&quot;jpaProperties&quot;&gt;
    &lt;props&gt;
      &lt;prop key=&quot;eclipselink.ddl-generation&quot;&gt;create-tables&lt;/prop&gt;
      &lt;prop key=&quot;eclipselink.logging.level&quot;&gt;INFO&lt;/prop&gt;
      &lt;prop key=&quot;eclipselink.weaving&quot;&gt;false&lt;/prop&gt;
      &lt;prop key=&quot;javax.persistence.jdbc.driver&quot;&gt;${sensormix_db.driverClassName}&lt;/prop&gt;
      &lt;prop key=&quot;javax.persistence.jdbc.url&quot;&gt;${sensormix_db.url}&lt;/prop&gt;
      &lt;prop key=&quot;javax.persistence.jdbc.user&quot;&gt;${sensormix_db.username}&lt;/prop&gt;
      &lt;prop key=&quot;javax.persistence.jdbc.password&quot;&gt;${sensormix_db.password}&lt;/prop&gt;
    &lt;/props&gt;
  &lt;/property&gt;
&lt;/bean&gt;

&lt;bean id=&quot;sensormixService&quot;
  class=&quot;com.google.developers.gdgfirenze.dataservice.SensormixServiceJpaImpl&quot;&gt;
  &lt;property name=&quot;entityManagerFactory&quot; ref=&quot;emf&quot; /&gt;
&lt;/bean&gt;

</pre>
    </article>
  </slide>


  <!-- Integration -->
  <slide class="segue header-green no-back">
    <aside class="gdbar big-green"><img src="images/sensormix_focus_integration.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Integration Bundle</h2>
    </hgroup>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2> The bundle for integrating sensors</h2>
    </hgroup>
    <article>
      <p>It defines Camel routes for input of samples from Android, Arduino and iOS</p>
      <p>It mostly uses Spring XML, an XSLT and a velocity template</p>
      <p>The only exception of code is the <b>SampleAdapter</b> class that transforms data from Protocol Buffer to our data model using Java</p>
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2>Let's review SensorMix interfaces</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/sensormix_camel_1.png" alt="SensorMix: Interfaces" title="SensorMix: Interfaces" />
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2>UDP and HTTP input routes </h2>
      <h3>Used for Android and Arduino sensors</h3>
    </hgroup>
    <article>
<pre class="prettyprint" data-lang="spring xml">
&lt;route&gt;
  <b>&lt;from uri=&quot;mina2:udp://0.0.0.0:10081&quot; /&gt;</b>
  &lt;to uri=&quot;seda:jsonEntry&quot; /&gt;
&lt;/route&gt;
</pre>

<pre class="prettyprint" data-lang="spring xml">
&lt;route&gt;
  <b>&lt;from uri=&quot;jetty:http://0.0.0.0:10080/sensormixSamplesEndpoint&quot; /&gt;</b>
  &lt;to uri=&quot;seda:jsonEntry&quot; /&gt;

  &lt;setHeader headerName=&quot;Content-Type&quot;&gt;
    <b>&lt;constant&gt;application/json&lt;/constant&gt;</b>
  &lt;/setHeader&gt;
  <b>&lt;to uri=&quot;velocity:vm_templates/json_response_template.vm&quot; /&gt;</b>
&lt;/route&gt;
</pre>
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2>JSON transformation route</h2>
    </hgroup>
    <article>
<pre class="prettyprint" data-lang="spring xml">
&lt;route&gt;
  &lt;from uri=&quot;seda:jsonEntry&quot; /&gt;
  &lt;convertBodyTo type=&quot;java.lang.String&quot; /&gt;

  &lt;unmarshal&gt;
    <b>&lt;xmljson elementName=&quot;item&quot; arrayName=&quot;list&quot; rootName=&quot;root&quot; /&gt;</b>
  &lt;/unmarshal&gt;

  <b>&lt;to uri=&quot;xslt:xslt_adapters/raw2cdm_adapter.xsl&quot; /&gt;</b>

  &lt;unmarshal&gt;
    <b>&lt;jaxb contextPath=&quot;com.google.developers.gdgfirenze.service&quot; /&gt;</b>
  &lt;/unmarshal&gt;

  &lt;to uri=&quot;seda:serviceEntry&quot; /&gt;
&lt;/route&gt;
</pre>
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2> TCP + ProtoBuf route</h2>
    </hgroup>
    <article class="smaller">
<pre class="prettyprint" data-lang="spring xml">
&lt;route&gt;
  <b>&lt;from uri=&quot;netty:tcp://0.0.0.0:10082/?decoders=#length-decoder&amp;amp;sync=false&quot; /&gt;</b>
  &lt;unmarshal&gt;
    <b>&lt;protobuf instanceClass=&quot;com.google.developers
      .gdgfirenze.protobuf.SensormixProtos$SampleMessage&quot; /&gt;</b>
  &lt;/unmarshal&gt;
  <b>&lt;bean ref=&quot;sampleAdapter&quot; method=&quot;transform&quot; /&gt;</b>
  &lt;to uri=&quot;seda:serviceEntry&quot; /&gt;
&lt;/route&gt;

<b>&lt;bean id=&quot;sampleAdapter&quot; 
  class=&quot;com.google.developers.gdgfirenze.integration.SampleAdapter&quot; /&gt;</b>
</pre>
<pre class="prettyprint" data-lang="java">
<b>package com.google.developers.gdgfirenze.integration;</b>

public <b>class SampleAdapter</b> {
  <b>public SamplesPayload transform(SampleMessage message)</b> {
    SamplesPayload ret = new SamplesPayload();
    // process 'SampleMessage' and return the adapted 'SamplesPayload'
    return ret;
  }
}
</pre>
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
      <h2> The output route toward the OSGi service</h2>
    </hgroup>
    <article>
<pre class="prettyprint" data-lang="spring xml">
&lt;osgi:reference <b>id=&quot;sensormixService&quot;</b>
    interface=&quot;com.google.developers.gdgfirenze.service.SensormixService&quot;
    timeout=&quot;30000&quot; cardinality=&quot;1..1&quot; /&gt;

&lt;route&gt;
  &lt;from uri=&quot;seda:serviceEntry&quot; /&gt;
  <b>&lt;to uri=&quot;bean:sensormixService?method=recordSamples(${body.samples})&quot; /&gt;</b>
&lt;/route&gt;
</pre>

    </article>
  </slide>
  <!-- GWT -->
  <slide class="segue header-green no-back">
    <aside class="gdbar big-green"><img src="images/sensormix_focus_webapp.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Admin WebApp Bundle</h2>
    </hgroup>
  </slide>


  <slide class="header-green">
    <hgroup>
      <h2>SensorMix GWT Web Application</h2>
    </hgroup>
    <article>
      <p>We have seen that for deploying a GWT Web Application on Karaf/ServiceMix we need to have:</p>
      <ul>
        <li>A WAR that is a Bundle (has OSGi headers).</li>
        <li>The gwt-servlet.jar installed correctly as bundle.</li>
      </ul>
      <p>What has been done for SensorMix?</p>
    </article>
  </slide>
  
  <slide class="header-green">
    <hgroup>
    <h2>Let's configure the maven-bundle-plugin</h2>
    </hgroup>
    <article class="smaller">
<pre class="prettyprint" data-lang="pom.xml">
&lt;instructions&gt;
  &lt;Bundle-SymbolicName&gt;${project.artifactId}&lt;/Bundle-SymbolicName&gt;
  &lt;Bundle-Description&gt;${project.description}&lt;/Bundle-Description&gt;

  <b>&lt;Web-ContextPath&gt;/${project.artifactId}&lt;/Web-ContextPath&gt;</b>

  <b>&lt;Bundle-ClassPath&gt;.,WEB-INF/classes&lt;/Bundle-ClassPath&gt;</b>

  <b>&lt;Import-Package&gt;
    com.google.gwt.user.client.rpc.*,
    com.google.gwt.user.client.rpc.core.com.google.gwt.core.shared,
    com.google.gwt.user.client.rpc.core.java.lang,
    com.google.gwt.user.client.rpc.core.java.math,
    com.google.gwt.user.client.rpc.core.java.sql,
    com.google.gwt.user.client.rpc.core.java.util,
    com.google.gwt.user.client.rpc.core.java.util.logging,
    com.google.gwt.user.server.rpc.core.java.lang,
    com.google.gwt.user.server.rpc.core.java.util,
    !com.google.gwt.*.client.*,
    *
  &lt;/Import-Package&gt;</b>
&lt;/instructions&gt;</pre>
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
<h2>Let's configure the maven-war-plugin</h2>
<h3>Remember the skinny war?</h3>
    </hgroup>
    <article>
<p>Let's remove dependencies from the lib:</p>
<pre class="prettyprint" data-lang="pom.xml">
&lt;packagingExcludes&gt;WEB-INF/lib/,
             WEB-INF/classes/META-INF/&lt;/packagingExcludes&gt;
</pre>

<p>Tell Maven to copy the Manifest where OSGi expects it to be:</p>
<pre class="prettyprint" data-lang="pom.xml">
&lt;archive&gt;
  &lt;manifestFile&gt;
    ${project.build.outputDirectory}/META-INF/MANIFEST.MF
  &lt;/manifestFile&gt;
&lt;/archive&gt;
</pre>
    </article>
  </slide>

<slide class="header-green">
    <hgroup>
<h2>Let's import the Canonical Data Model</h2>
    </hgroup>
    <article class="smaller">
<p>In the file SensormixAdminApp.gwt.xml:</p>
<pre class="prettyprint" data-lang=".gwt.xml">
  &lt;inherits name='com.google.developers.gdgfirenze.Sensormix' /&gt;
</pre>

<p>In pom.xml:</p>
<pre class="prettyprint" data-lang="pom.xml">
&lt;dependency&gt;
  &lt;groupId&gt;com.google.developers.gdgfirenze&lt;/groupId&gt;
  &lt;artifactId&gt;sensormix-datamodel-api&lt;/artifactId&gt;
  &lt;version&gt;${project.version}&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.google.developers.gdgfirenze&lt;/groupId&gt;
  &lt;artifactId&gt;sensormix-datamodel-api&lt;/artifactId&gt;
  &lt;version&gt;${project.version}&lt;/version&gt;
  <b>&lt;classifier&gt;sources&lt;/classifier&gt;</b>
&lt;/dependency&gt;</pre>
    </article>
  </slide>



  <slide class="header-green">
    <hgroup>
<h2>GWT RPC Plumbing diagram</h2>
<h3>We started from this...</h3>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/sensormix_gwt_1.png" alt="GWT RPC Plumbing diagram" title="GWT RPC Plumbing diagram" />
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
<h2>SensorMix RPC Plumbing diagram</h2>
<h3>...to get this</h3>
    </hgroup>
<article class="flexbox vcenter">
      <img src="images/sensormix_gwt_2.png" alt="Sensormix RPC Plumbing diagram" title="Sensormix RPC Plumbing diagram" />
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
<h2>GWT RPC in Sensormix</h2>
<h3>Client Side</h3>
    </hgroup>
    <article class="smaller">
<p>Call GWT.create() to get the service:</p>
<pre class="prettyprint" data-lang="java">
GwtSensormixServiceAsync sensormixService 
    = GWT.create(GwtSensormixService.class);
</pre>
<p>Use the service:</p>
<pre class="prettyprint" data-lang="java">
sensormixService.listSensorsIds(new AsyncCallback<List>() {
  @Override
  public void onFailure(Throwable caught) {
    // handle the request failure
  }

  @Override
  public void onSuccess(List result) {
    // handle the response from the service
  }
});
</pre>
    </article>
  </slide>

  <slide class="header-green">
    <hgroup>
<h2>GWT RPC in Sensormix</h2>
<h3>Server Side</h3>
    </hgroup>
    <article class="smaller">
<p>SensormixServiceProxy.java is GWT RPC service that uses an OSGi service. 
  During the initialization, it get a reference to it using the OSGi Framework API.</p>
<pre class="prettyprint" data-lang="java">
public void init() throws ServletException {

  final BundleContext context = FrameworkUtil.getBundle(this.getClass()).getBundleContext();
  tracker = new ServiceTracker(context, SensormixService.class.getName(), null);
  tracker.open();
}
</pre>

<p>How does it use the OSGi service?</p>
<pre class="prettyprint" data-lang="java">
private SensormixService getService() {
  return (SensormixService) tracker.waitForService(10000);
}

public List&lt;String&gt; listSensorsIds() {
  return getService().listSensorsIds();
}
</pre>
    </article>
  </slide>




  <slide class="segue dark nobackground">
    <aside class="gdbar"><img src="images/logo_sensormix_c.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Cool Facts</h2>
      <h3>Why we love this architecture</h3>
    </hgroup>
  </slide>


  <slide class="header-dark">
    <hgroup>
      <img style="float:right;margin-top:10px;" src="images/arduino_logo.png" alt="Arduino Logo" title="Arduino Logo" />
      <h2>Integrating Arduino</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img style="height: 100%;" src="images/arduino_circuit.png" alt="Arduino Circuit" title="Arduino Circuit" />
  </article>
  </slide>

  <slide class="header-dark">
    <hgroup>
      <img style="float:right;margin-top:10px;" src="images/arduino_logo.png" alt="Arduino Logo" title="Arduino Logo" />
      <h2>Integrating Arduino</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img style="height: 100%;" src="images/arduino_sheet.png" alt="Arduino Sheet" title="Arduino Sheet" />
    </article>
  </slide>

  <slide class="header-dark">
    <hgroup>
      <img style="float:right;"  src="images/android_logo.png" alt="Android Logo" title="Android Logo"  />
      <h2> 
        Integrating Android
      </h2>
    </hgroup>
    <article>
      <pre class="prettyprint" data-lang="java">

        HttpPost httppost = new HttpPost(url.toString());
        httppost.setHeader("Content-type", "application/json");

        StringEntity se = new StringEntity(bodyForHttpPostRequest);
        se.setContentEncoding(new BasicHeader(HTTP.CONTENT_TYPE,
            "application/json"));
        httppost.setEntity(se);

        HttpResponse response = httpclient.execute(httppost);
        String temp = EntityUtils.toString(response.getEntity());
        logger.info("JSON post response: " + temp);

      </pre>    
    </article>
  </slide>

  <slide class="header-dark">
    <hgroup>
      <img style="float:right;"  src="images/android_logo.png" alt="Android Logo" title="Android Logo"  />
      <h2> 
        Integrating Android - NFC
      </h2>
    </hgroup>
    <article  class="smaller">
      <pre class="prettyprint" data-lang="java">

      Tag tag = getIntent().getParcelableExtra(NfcAdapter.EXTRA_TAG);
      StringBuilder id = new StringBuilder();
      byte[] data = tag.getId();
      for (int i = 0; i &lt; data.length; i++) {
        id.append(String.format("%02x", data[i]));
        if (i &lt; data.length - 1) {
          id.append(":");
        }
      }
      JSONObject jsonSamplePacket = new JSONObject();
      JSONObject obj = new JSONObject();
      jsonSamplePacket.put("sample", obj);
      obj.put("device_id", "the device id");
      obj.put("time", dateFormat.format(new Date()));
      obj.put("nfc", id);
      Intent intent = new Intent(this, DataSenderService.class);
      intent.putExtra(DataSenderService.INTENT_EXTRA,
          jsonSamplePacket.toString());
      startService(intent);
      </pre>    
    </article>
  </slide>



  <slide class="header-dark">
    <hgroup>
      <h2>Let's install ServiceMix</h2>
    </hgroup>
    <article class="flexbox">
      <div class="build fade">
        <img style="position: absolute;left:50%;margin-left:-420px;margin-top:-30px;" src="images/cool_install_servicemix_1.png" alt="" title="" />
        <img style="position: absolute;left:50%;margin-left:-220px;margin-top:30px;" src="images/cool_install_servicemix_2.png" alt="" title="" />
        <img style="position: absolute;left:50%;margin-left:-420px;margin-top:-30px;" src="images/cool_install_servicemix_3.png" alt="" title="" />
        <img style="position: absolute;left:50%;margin-left:-410px;margin-top:-20px;" src="images/cool_install_servicemix_4.png" alt="" title="" />
        <img style="position: absolute;left:50%;margin-left:-300px;margin-top:-10px;" src="images/cool_install_servicemix_5.png" alt="" title="" />
        <img style="position: absolute;left:50%;margin-left:-420px;margin-top:-30px;" src="images/cool_install_servicemix_6.png" alt="" title="" />
        <img style="position: absolute;left:50%;margin-left:-400px;margin-top:-20px;" src="images/cool_install_servicemix_7.png" alt="" title="" />
        <img style="position: absolute;left:50%;margin-left:-380px;margin-top:-10px;" src="images/cool_install_servicemix_8.png" alt="" title="" />
      </div>
    </article>
  </slide>

  <slide class="header-dark">
    <hgroup>
      <h2>Creating application distribution</h2>
    </hgroup>
    <article class="flexbox vcenter">
        <img src="images/cool_dist_features.png" alt="" title="" />
    </article>
  </slide>

  <slide class="header-dark">
    <hgroup>
      <h2>Karaf Features</h2>
    </hgroup>
    <article class="smaller">
<pre class="prettyprint" data-lang="features.xml">
&lt;features name=&#39;sensormix-1.0.0&#39;&gt;
  &lt;feature name=&quot;sensormix-core&quot; version=&quot;1.0.0&quot;&gt;
    &lt;bundle&gt;mvn:com.google.developers.gdgfirenze/sensormix-datamodel-api/1.0.0&lt;/bundle&gt;
  &lt;/feature&gt;

  &lt;feature name=&quot;sensormix-dataservice&quot; version=&quot;1.0.0&quot;&gt;
    &lt;feature version=&quot;1.0.0&quot;&gt;sensormix-core&lt;/feature&gt;
    &lt;feature&gt;spring-orm&lt;/feature&gt;
    &lt;!-- ... --&gt;
    &lt;bundle&gt;mvn:mysql/mysql-connector-java/5.1.26&lt;/bundle&gt;
    &lt;bundle&gt;mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-dbcp/1.4_3&lt;/bundle&gt;
    &lt;bundle&gt;mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.javax-inject/1_2&lt;/bundle&gt;
    &lt;bundle&gt;mvn:org.eclipse.persistence/javax.persistence/2.1.0&lt;/bundle&gt;
    &lt;bundle&gt;mvn:org.eclipse.persistence/org.eclipse.persistence.jpa/2.5.0&lt;/bundle&gt;
    &lt;!-- ... --&gt;
    &lt;bundle&gt;mvn:com.google.developers.gdgfirenze/sensormix-dataservice-bundle/1.0.0&lt;/bundle&gt;
  &lt;/feature&gt;

  <b>&lt;feature name=&quot;sensormix&quot; version=&quot;1.0.0&quot;&gt;
    &lt;feature version=&quot;1.0.0&quot;&gt;sensormix-dataservice&lt;/feature&gt;
    &lt;feature version=&quot;1.0.0&quot;&gt;sensormix-webservice&lt;/feature&gt;
  &lt;/feature&gt;</b>
&lt;/features&gt;
</pre>        
    </article>
  </slide>

  <slide class="header-dark">
    <hgroup>
      <h2>The Karaf's Features Maven Plugin</h2>
    </hgroup>
    <article class="smaller">
<pre class="prettyprint" data-lang="features.xml">
&lt;plugin&gt;
  &lt;groupId&gt;org.apache.karaf.tooling&lt;/groupId&gt;
  &lt;artifactId&gt;features-maven-plugin&lt;/artifactId&gt;
  &lt;version&gt;${features.plugin.version}&lt;/version&gt;
  &lt;executions&gt;
    &lt;execution&gt;
      <b>&lt;id&gt;add-features-to-repo&lt;/id&gt;</b>
      &lt;phase&gt;package&lt;/phase&gt;
      &lt;goals&gt;
        &lt;goal&gt;add-features-to-repo&lt;/goal&gt;
      &lt;/goals&gt;
      &lt;configuration&gt;
        &lt;descriptors&gt;
          <b>&lt;descriptor&gt;com.google.developers.gdgfirenze
                      /sensormix-deploy-features/1.0.0/xml/features&lt;/descriptor&gt;</b>
        &lt;/descriptors&gt;
        &lt;features&gt;
          <b>&lt;feature&gt;sensormix/1.0.0&lt;/feature&gt;</b>
        &lt;/features&gt;
        <b>&lt;repository&gt;target/local-repo&lt;/repository&gt;</b>
      &lt;/configuration&gt;
    &lt;/execution&gt;
  &lt;/executions&gt;
&lt;/plugin&gt;
</pre>        
    </article>
  </slide>

  <slide class="header-dark">
    <hgroup>
      <h2>Let's install SensorMix</h2>
    </hgroup>
    <article class="flexbox">
      <div class="build fade">
        <img style="position: absolute;left:50%;margin-left:-420px;margin-top:-30px;" src="images/cool_install_sensormix_1.png" alt="" title="" />
        <!--<img style="position: absolute;left:50%;margin-left:-220px;margin-top:30px;" src="images/cool_install_sensormix_2.png" alt="" title="" />-->
        <img style="position: absolute;left:50%;margin-left:-420px;margin-top:-30px;" src="images/cool_install_sensormix_3.png" alt="" title="" />
        <!--<img style="position: absolute;left:50%;margin-left:-410px;margin-top:-20px;" src="images/cool_install_sensormix_4.png" alt="" title="" />-->
        <img style="position: absolute;left:50%;margin-left:-420px;margin-top:-10px;" src="images/cool_install_sensormix_5.png" alt="" title="" />
        <img style="position: absolute;left:50%;margin-left:-490px;margin-top:10px;" src="images/cool_install_sensormix_6.png" alt="" title="" />
      </div>
    </article>
  </slide>


  <slide class="header-dark">
    <hgroup>
      <h2>Kryo and Benchmark</h2>
    </hgroup>
    <article class="bigger">
      <p>For JPA persistence datamodel we used only one class for all samples. This class has a field <code>byte[]</code> that is the sample serialization (Kryo).</p>

      <p>Using JPA abstraction we realized a benchmark to evaluate performance and size. So we were able to choose the best solution.</p>
    </article>
  </slide>

  <slide class="header-dark">
    <hgroup>
      <h2>ServiceMix: How much overhead?</h2>
      <h3>ServiceMix standard distribution is around 65MB on the file system</h3>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/cool_servicemix_footprint.jpg" alt="" title="" />
    </article>
  </slide>



  <slide class="header-dark">
    <hgroup>
      <h2>Maven ed Eclipse</h2>
    </hgroup>
    <article class="bigger">
      <p>SensorMix has been developed in a <b>Team</b> using <b>Maven</b> and <b>Eclipse</b>.</p>
      <p>In particular:</p>
      <ul class="build">
        <li>The Webapp (GWT) is developed in the same Java IDE</li>
        <li>Distribution made with Karaf's Features Maven Plugin</li>
        <li>Checkstyle and PMD used to improve Team cooperation</li>
      </ul>
    </article>
  </slide>

  <slide class="segue no-back nobackground">
    <aside class="gdbar"><img src="images/logo_sensormix_c.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Conclusions</h2>
      <h3>Conclusions and bibliographic reference</h3>
    </hgroup>
  </slide>

  <slide class="fill nobackground text-on-image" style="background-image: url(images/conclusion_issue.jpg)">
    <hgroup>
      <h2>Issue on GWT</h2>
    </hgroup>
    <article>
      <h3>We need GWT 2.6.0 to be OSGi-fied:</h3>
      <ul class="build">
        <li>please help us, star this issue on GWT if you think this approach is interesting: 
          <ul><li><a href="http://goo.gl/GEuVBR">http://goo.gl/GEuVBR</a></li></ul></li>
        <li>or vote this issue on Jira so to have an equivalent bundle released from ServiceMix team:<br/>
          <ul><li><a href="http://goo.gl/jFsVcP">http://goo.gl/jFsVcP</a></li></ul></li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Talk slides and source code</h2>
    </hgroup>
    <article class="bigger">
      <dl>
        <dt>Slides:</dt>
        <dd><a href="http://cristcost.github.io/sensormix/">http://cristcost.github.io/sensormix/</a></dd>
        <dt>Sensormix:</dt>
        <dd><a href="https://github.com/cristcost/sensormix/">https://github.com/cristcost/sensormix/</a></dd>
        <dt>Sensormix Android:</dt>
        <dd><a href="https://github.com/cristcost/sensormix-android/">https://github.com/cristcost/sensormix-android/</a></dd>
        <dt>Sensormix Arduino:</dt>
        <dd><a href="https://github.com/michelefi/sensormix-arduino/">https://github.com/michelefi/sensormix-arduino/</a></dd>
      </dl>
    </article>
  </slide>
  
  <slide class="fill white nobackground text-on-dark-image" style="background-image: url(images/conclusion_books.jpg)">
    <hgroup>
      <h2 class="white">Books</h2>
    </hgroup>
    <article class="bigger">
      <dl>
        <dt>Camel in Action</dt><dd>C. Ibsen, J. Anstey - Manning</dd>
        <dt>Enterprise Integration Patterns</dt><dd>G. Hohpe, B. Woolf - Addison Wesley</dd>
        <dt>Spring DM in Action</dt><dd>A. Cogoluègnes, T. Templier, A. Piper - Manning</dd>
        <dt>OSGi in Action</dt><dd>R. S. Hall, K. Pauls, S. McCulloch, D. Savage - Manning</dd>
        <dt>OSGi In depth</dt><dd>Alexandre de Castro Alves - Manning</dd>
      </dl>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Links</h2>
    </hgroup>
    <article class="bigger">
      <dl>     
      <dt>Apache Camel:</dt>
      <dd><a href="http://camel.apache.org/">http://camel.apache.org/</a></dd>
      <dt>Apache ServiceMix:</dt>
      <dd><a href="http://servicemix.apache.org/">http://servicemix.apache.org/</a></dd>
      <dt>Apache Karaf:</dt>
      <dd><a href="http://karaf.apache.org/">http://karaf.apache.org/</a></dd>
      <dt>GWT:</dt>
      <dd><a href="http://www.gwtproject.org/">http://www.gwtproject.org/</a></dd>
      </dl>
    </article>
  </slide>


  <slide>
    <article class="flexbox vcenter">
      <div>
        <h2 style="font-size:10em;">Q&amp;A</h2>
      </div>
    </article>
  </slide>




  <slide class="thank-you-slide segue nobackground">
    <aside class="gdbar right"><img src="images/logo_sensormix_c.png"></aside>
    <article class="flexbox vleft auto-fadein">
      <h2>&lt;Thank You!&gt;</h2>
    </article>
    <p class="auto-fadein" data-config-contact></p>
  </slide>

  <slide class="logoslide dark nobackground">
    <article class="flexbox vcenter">
      <span><img src="images/gdg_firenze_logo.png"></span>
    </article>
  </slide>

  <slide class="backdrop"></slide>

</slides>

<script>
</script>

<!--[if IE]>
  <script src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
  <script>CFInstall.check({mode: 'overlay'});</script>
<![endif]-->
</body>
</html>
